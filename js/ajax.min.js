function CAjaxThread(t){this.TID=t,this.httpRequest=this._CreateHttpObject(),this.arAction=[]}function CAjax(){this.arThreads={},this.obTemporary=null}function CAjaxForm(t,e,n){this.obForm=t,this.obHandler=e,this.obFrame=null,this.isFormProcessed=!1,this.bFirst=null!=n&&n,this.__tmpFormTarget="",this.obAJAXIndicator=null,this.currentBrowserDetected="",window.opera?this.currentBrowserDetected="Opera":navigator.userAgent&&(-1!=navigator.userAgent.indexOf("MSIE")?this.currentBrowserDetected="IE":-1!=navigator.userAgent.indexOf("Firefox")&&(this.currentBrowserDetected="Firefox")),this.IsIE9=!!document.documentMode&&document.documentMode>=9}CAjaxThread.prototype._CreateHttpObject=function(){var t=null;if(window.XMLHttpRequest)try{t=new XMLHttpRequest}catch(t){}else if(window.ActiveXObject){try{t=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}if(!t)try{t=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){}}return t},CAjaxThread.prototype.addAction=function(t){this.arAction.push(t)},CAjaxThread.prototype.clearActions=function(){this.arAction=[]},CAjaxThread.prototype.nextAction=function(){return this.arAction.shift()},CAjaxThread.prototype.Clear=function(){this.arAction=null,this.httpRequest=null},CAjax.prototype._PrepareData=function(t,e){var n="";if(null!=t)for(var o in t){n.length>0&&(n+="&");var i=jsAjaxUtil.urlencode(o);e&&(i=e+"["+i+"]"),"object"==typeof t[o]?n+=this._PrepareData(t[o],i):n+=i+"="+jsAjaxUtil.urlencode(t[o])}return n},CAjax.prototype.GetThread=function(t){return this.arThreads[t]},CAjax.prototype.InitThread=function(){for(;;){var t="TID"+Math.floor(1e6*Math.random());if(!this.arThreads[t])break}return this.arThreads[t]=new CAjaxThread(t),t},CAjax.prototype.AddAction=function(t,e){this.arThreads[t]&&this.arThreads[t].addAction(e)},CAjax.prototype._OnDataReady=function(t,e){if(this.arThreads[t])for(;obHandler=this.arThreads[t].nextAction();)obHandler(e)},CAjax.prototype._Close=function(t){this.arThreads[t]&&(this.arThreads[t].Clear(),this.arThreads[t]=null)},CAjax.prototype._SetHandler=function(t){var e=this;this.arThreads[t].httpRequest.onreadystatechange=function(){if(!e.bCancelled&&e.arThreads[t]&&e.arThreads[t].httpRequest&&4==e.arThreads[t].httpRequest.readyState){var n="Redirect"==e.arThreads[t].httpRequest.getResponseHeader("X-Bitrix-Ajax-Status"),o=e.arThreads[t].httpRequest.responseText;jsAjaxParser.mode="implode",o=jsAjaxParser.process(o),n||e._OnDataReady(t,o),e.__prepareOnload(),jsAjaxParser.code.length>0&&jsAjaxUtil.EvalPack(jsAjaxParser.code),e.__runOnload(),e._Close(t)}},jsEvent.addEvent(document,"keypress",(function(n){n||(n=window.event),n&&27==n.keyCode&&(e._Close(t),jsEvent.removeEvent(document,"keypress",this))}))},CAjax.prototype.__prepareOnload=function(){this.obTemporary=window.onload,window.onload=null},CAjax.prototype.__runOnload=function(){window.onload&&window.onload(),window.onload=this.obTemporary,this.obTemporary=null},CAjax.prototype.Send=function(t,e,n){if(this.arThreads[t]){if(null!=n)var o=this._PrepareData(n);else o="";return o.length>0&&(-1==e.indexOf("?")?e+="?"+o:e+="&"+o),this.arThreads[t].httpRequest?(this.arThreads[t].httpRequest.open("GET",e,!0),this._SetHandler(t),this.arThreads[t].httpRequest.send("")):void 0}},CAjax.prototype.Post=function(t,e,n){var o="";if(null!=n&&(o=this._PrepareData(n)),this.arThreads[t].httpRequest)return this.arThreads[t].httpRequest.open("POST",e,!0),this._SetHandler(t),this.arThreads[t].httpRequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),this.arThreads[t].httpRequest.send(o)},CAjaxForm.prototype.setProcessedFlag=function(t){t=null==t||!!t,this.obForm.bxAjaxProcessed=t,this.isFormProcessed=t},CAjaxForm.isFormProcessed=function(t){return!!t.bxAjaxProcessed&&t.bxAjaxProcessed},CAjaxForm.prototype.process=function(){var t=this;function e(){if(t.obFrame.contentWindow.document&&0!=t.obFrame.contentWindow.document.body.innerHTML.length&&(null!=t.obHandler&&t.obHandler(t.obFrame.contentWindow.document.body.innerHTML),t.obFrame.contentWindow.AJAX_runExternal&&t.obFrame.contentWindow.AJAX_runExternal(),t.obFrame.contentWindow.AJAX_runGlobal&&t.obFrame.contentWindow.AJAX_runGlobal(),t.bFirst)){try{t.obForm.target=t.__tmpFormTarget,t.obAJAXIndicator.parentNode.removeChild(t.obAJAXIndicator),t.obForm.bxAjaxProcessed=!1}catch(e){t.obForm=null}t.obAJAXIndicator=null,"IE"!=this.currentBrowserDetected&&jsEvent.removeAllEvents(t.obFrame);setTimeout("document.body.removeChild(document.getElementById('"+t.obFrame.id+"'));",100);t.obFrame=null,window.onFormLoaded&&(window.onFormLoaded(),window.onFormLoaded=null)}}if(!this.obForm.target||"AJAX_"!=this.obForm.target.substring(0,5)){"IE"==this.currentBrowserDetected?this.IsIE9?(this.obAJAXIndicator=document.createElement("input"),this.obAJAXIndicator.setAttribute("name","AJAX_CALL"),this.obAJAXIndicator.setAttribute("type","hidden")):this.obAJAXIndicator=document.createElement('<input name="AJAX_CALL" type="hidden" />'):(this.obAJAXIndicator=document.createElement("INPUT"),this.obAJAXIndicator.type="hidden",this.obAJAXIndicator.name="AJAX_CALL"),this.obAJAXIndicator.value="Y",this.obForm.appendChild(this.obAJAXIndicator);var n="AJAX_"+Math.round(1e5*Math.random());"IE"==this.currentBrowserDetected?this.IsIE9?(this.obFrame=document.createElement("iframe"),this.obFrame.setAttribute("name",n)):this.obFrame=document.createElement('<iframe name="'+n+'"></iframe>'):this.obFrame=document.createElement("IFRAME"),this.obFrame.style.display="none",this.obFrame.src="javascript:''",this.obFrame.id=n,this.obFrame.name=n,document.body.appendChild(this.obFrame),this.__tmpFormTarget=this.obForm.target,this.obForm.target=n,"IE"==this.currentBrowserDetected?this.obFrame.attachEvent("onload",e):jsEvent.addEvent(this.obFrame,"load",e),this.setProcessedFlag()}};var jsAjaxParser={code:[],mode:"implode",regexp:null,regexp_src:null,process:function(t){for(this.code=[],null==this.regexp&&(this.regexp=/(<script([^>]*)>)([\S\s]*?)(<\/script>)/i);;){var e=t.match(this.regexp);if(null==e)break;var n=e.index,o=e[0].length;if(n>0&&this.code.push({TYPE:"STRING",DATA:t.substring(0,n)}),void 0===e[1]||-1==e[1].indexOf("src=")){var i=e[3];i=i.replace("\x3c!--",""),this.code.push({TYPE:"SCRIPT",DATA:i})}else{null==this.regexp_src&&(this.regexp_src=/src="([^"]*)?"/i);var r=this.regexp_src.exec(e[1]);null!=r&&r[1]&&this.code.push({TYPE:"SCRIPT_EXT",DATA:r[1]})}t=t.substring(n+o)}if(t.length>0&&this.code.push({TYPE:"STRING",DATA:t}),"implode"==this.mode){t="";for(var a=0,s=this.code.length;a<s;a++)"STRING"==this.code[a].TYPE&&(t+=this.code[a].DATA);return t}return this.code}},jsAjaxUtil={RemoveAllChild:function(t){try{for(;t.childNodes.length>0;)jsEvent.clearObject(t.childNodes[0]),t.removeChild(t.childNodes[0])}catch(t){}},EvalGlobal:function(t){window.execScript?window.execScript(t,"javascript"):jsAjaxUtil.IsSafari()?window.setTimeout(t,0):window.eval(t)},arLoadedScripts:[],__isScriptLoaded:function(t){for(var e=0;e<jsAjaxUtil.arLoadedScripts.length;e++)if(jsAjaxUtil.arLoadedScripts[e]==t)return!0;return!1},EvalExternal:function(t){if(!/\/bitrix\/js\/main\/ajax.js$/i.test(t)&&!/\/bitrix\/js\/main\/core\/core.js$/i.test(t)&&!jsAjaxUtil.__isScriptLoaded(t)){jsAjaxUtil.arLoadedScripts.push(t);var e=new CAjaxThread;e.httpRequest.open("GET",t,!1),e.httpRequest.send("");var n=e.httpRequest.responseText;e.Clear(),e=null,jsAjaxUtil.EvalGlobal(n)}},EvalPack:function(t){for(var e=0,n=t.length;e<n;e++)"SCRIPT_EXT"==t[e].TYPE||"SCRIPT_SRC"==t[e].TYPE?jsAjaxUtil.EvalExternal(t[e].DATA):"SCRIPT"==t[e].TYPE&&jsAjaxUtil.EvalGlobal(t[e].DATA)},urlencode:function(t){return escape(t).replace(new RegExp("\\+","g"),"%2B")},trim:function(t){var e,n;return n=/^[ \r\n]+/g,e=t.replace(n,""),n=/[ \r\n]+$/g,e=e.replace(n,"")},GetWindowSize:function(){var t,e,n,o,i,r;return self.innerHeight?(t=self.innerWidth,e=self.innerHeight):document.documentElement&&document.documentElement.clientHeight?(t=document.documentElement.clientWidth,e=document.documentElement.clientHeight):document.body&&(t=document.body.clientWidth,e=document.body.clientHeight),self.pageYOffset?(n=self.pageXOffset,o=self.pageYOffset):document.documentElement&&document.documentElement.scrollTop?(n=document.documentElement.scrollLeft,o=document.documentElement.scrollTop):document.body&&(n=document.body.scrollLeft,o=document.body.scrollTop),document.compatMode&&"CSS1Compat"==document.compatMode?(i=document.documentElement.scrollWidth,r=document.documentElement.scrollHeight):(r=document.body.scrollHeight>document.body.offsetHeight?document.body.scrollHeight:document.body.offsetHeight,i=document.body.scrollWidth>document.body.offsetWidth||document.compatMode&&"BackCompat"==document.compatMode||document.documentElement&&!document.documentElement.clientWidth?document.body.scrollWidth:document.body.offsetWidth),{innerWidth:t,innerHeight:e,scrollLeft:n,scrollTop:o,scrollWidth:i,scrollHeight:r}},GetRealPos:function(t){if(t.getBoundingClientRect){var e=t.getBoundingClientRect(),n=jsAjaxUtil.GetWindowSize();return{left:e.left+n.scrollLeft,top:e.top+n.scrollTop,right:e.right+n.scrollLeft,bottom:e.bottom+n.scrollTop}}if(!t||!t.offsetParent)return!1;var o=Array();o.left=t.offsetLeft,o.top=t.offsetTop;for(var i=t.offsetParent;i&&"BODY"!=i.tagName;)o.left+=i.offsetLeft,o.top+=i.offsetTop,i=i.offsetParent;return o.right=o.left+t.offsetWidth,o.bottom=o.top+t.offsetHeight,o},IsIE:function(){return document.attachEvent&&!jsAjaxUtil.IsOpera()},IsOpera:function(){return-1!=navigator.userAgent.toLowerCase().indexOf("opera")},IsSafari:function(){var t=navigator.userAgent.toLowerCase();return/webkit/.test(t)},LoadData:function(t,e){if(e){var n=jsAjax.InitThread();return jsAjax.AddAction(n,e),jsAjax.Send(n,t),n}},PostData:function(t,e,n){if(n){var o=jsAjax.InitThread();return jsAjax.AddAction(o,n),jsAjax.Post(o,t,e),o}},__LoadDataToDiv:function(t,e,n,o){if(null==n&&(n=!0),null==o&&(o=!0),"string"==typeof e||"object"==typeof e&&e.constructor==String)var i=document.getElementById(e);else i=e;if(i){var r=Math.round(1e6*Math.random());jsAjaxUtil.ShowLocalWaitWindow(r,i,o);jsAjaxUtil.LoadData(t,(function(t){i&&(jsAjaxUtil.CloseLocalWaitWindow(r,i),n?(jsAjaxUtil.RemoveAllChild(i),i.innerHTML=t):i.innerHTML+=t)}))}},InsertDataToNode:function(t,e,n){null==n&&(n=!0),jsAjaxUtil.__LoadDataToDiv(t,e,!0,n)},AppendDataToNode:function(t,e,n){null==n&&(n=!0),jsAjaxUtil.__LoadDataToDiv(t,e,!1,n)},GetStyleValue:function(t,e){if(t.currentStyle)var n=t.currentStyle[e];else if(window.getComputedStyle)n=document.defaultView.getComputedStyle(t,null).getPropertyValue(e);return n},ShowLocalWaitWindow:function(t,e,n){if("string"==typeof e||"object"==typeof e&&e.constructor==String)var o=document.getElementById(e);else o=e;if(o.getBoundingClientRect)var i=o.getBoundingClientRect(),r=jsAjaxUtil.GetWindowSize(),a={left:i.left+r.scrollLeft,top:i.top+r.scrollTop,right:i.right+r.scrollLeft,bottom:i.bottom+r.scrollTop};else a=jsAjaxUtil.GetRealPos(o);var s=o.id;if(a){if(null==n&&(n=!0),n){var d=document.body.appendChild(document.createElement("DIV"));d.id="waitshadow_"+s+"_"+t,d.className="waitwindowlocalshadow",d.style.top=a.top-5+"px",d.style.left=a.left-5+"px",d.style.height=a.bottom-a.top+10+"px",d.style.width=a.right-a.left+10+"px"}var l=document.body.appendChild(document.createElement("DIV"));l.id="wait_"+s+"_"+t,l.className="waitwindowlocal";var c=a.top+5;if(c<document.body.scrollTop&&(c=document.body.scrollTop+5),l.style.top=c+"px",l.style.left=a.left+5+"px",jsAjaxUtil.IsIE()){var h=document.createElement("IFRAME");h.src="javascript:''",h.id="waitframe_"+s+"_"+t,h.className="waitwindowlocal",h.style.width=l.offsetWidth+"px",h.style.height=l.offsetHeight+"px",h.style.left=l.style.left,h.style.top=l.style.top,document.body.appendChild(h)}jsEvent.addEvent(document,"keypress",(function n(o){o||(o=window.event),o&&27==o.keyCode&&(jsAjaxUtil.CloseLocalWaitWindow(t,e),jsEvent.removeEvent(document,"keypress",n))}))}},CloseLocalWaitWindow:function(t,e){if("string"==typeof e||"object"==typeof e&&e.constructor==String)var n=document.getElementById(e);else n=e;var o=n.id,i=document.getElementById("waitshadow_"+o+"_"+t);i&&document.body.removeChild(i);var r=document.getElementById("waitframe_"+o+"_"+t);r&&document.body.removeChild(r);var a=document.getElementById("wait_"+o+"_"+t);a&&document.body.removeChild(a)},SendForm:function(t,e){if("string"==typeof t||"object"==typeof t&&t.constructor==String)var n=document.getElementById(t);else n=t;return(!n.name||n.name.length<=0)&&(n.name="AJAXFORM_"+Math.floor(1e6*Math.random())),new CAjaxForm(n,e,!0).process(),!0},InsertFormDataToNode:function(t,e,n){return null==n&&(n=!0),jsAjaxUtil.__LoadFormToDiv(t,e,!0,n)},AppendFormDataToNode:function(t,e,n){return null==n&&(n=!0),jsAjaxUtil.__LoadFormToDiv(t,e,!1,n)},__LoadFormToDiv:function(t,e,n,o){if(null==n&&(n=!0),null==o&&(o=!0),"string"==typeof e||"object"==typeof e&&e.constructor==String)var i=document.getElementById(e);else i=e;if(i)return jsAjaxUtil.ShowLocalWaitWindow(i.id,i,o),jsAjaxUtil.SendForm(t,(function(t){i&&(n?(jsAjaxUtil.RemoveAllChild(i),i.innerHTML=t):i.innerHTML+=t,jsAjaxUtil.CloseLocalWaitWindow(i.id,i))}))},UpdatePageData:function(t){t.TITLE&&jsAjaxUtil.UpdatePageTitle(t.TITLE),t.NAV_CHAIN&&jsAjaxUtil.UpdatePageNavChain(t.NAV_CHAIN),t.CSS&&t.CSS.length>0&&jsAjaxUtil.UpdatePageCSS(t.CSS),t.SCRIPTS&&t.SCRIPTS.length>0&&jsAjaxUtil.UpdatePageScripts(t.SCRIPTS)},UpdatePageScripts:function(t){for(var e=0;e<t.length;e++)jsAjaxUtil.EvalExternal(t[e])},UpdatePageCSS:function(t){jsStyle.UnloadAll();for(var e=0;e<t.length;e++)jsStyle.Load(t[e])},UpdatePageTitle:function(t){var e=document.getElementById("pagetitle");e&&(e.removeChild(e.firstChild),e.firstChild?e.insertBefore(document.createTextNode(t),e.firstChild):e.appendChild(document.createTextNode(t))),document.title=t},UpdatePageNavChain:function(t){var e=document.getElementById("navigation");e&&(e.innerHTML=t)},ScrollToNode:function(t){if("string"==typeof t||"object"==typeof t&&t.constructor==String)var e=document.getElementById(t);else e=t;if(e.scrollIntoView)e.scrollIntoView(!0);else{var n=jsAjaxUtil.GetRealPos(e);window.scrollTo(n.left,n.top)}}},jsStyle={arCSS:{},bInited:!1,Init:function(){var t=document.getElementsByTagName("LINK");if(t.length>0)for(var e=0;e<t.length;e++)if(t[e].href){var n=t[e].href,o=n.indexOf("://");-1!=o&&(n=n.substr(n.indexOf("/",o+3))),t[e].bxajaxflag=!1,this.arCSS[n]=t[e]}this.bInited=!0},Load:function(t){if(this.bInited||this.Init(),null==this.arCSS[t]){var e=document.createElement("STYLE");e.type="text/css";var n=document.getElementsByTagName("HEAD")[0];if(n.insertBefore(e,n.firstChild),jsAjaxUtil.IsIE())e.styleSheet.addImport(t);else{var o=new CAjaxThread;o.httpRequest.onreadystatechange=null,o.httpRequest.open("GET",t,!1),o.httpRequest.send("");var i=o.httpRequest.responseText,r=t.lastIndexOf("/");if(-1!=r){var a=t.substring(0,r);i=i.replace(/url\(([^\/\\].*?)\)/gi,"url("+a+"/$1)")}o.Clear(),o=null,e.appendChild(document.createTextNode(i))}}else this.arCSS[t].disabled=!1},Unload:function(t){this.bInited||this.Init(),null!=this.arCSS[t]&&(this.arCSS[t].disabled=!0)},UnloadAll:function(){if(this.bInited)for(var t in this.arCSS)this.arCSS[t].bxajaxflag&&this.Unload(t);else this.Init()}},jsEvent={objectList:[null],objectEventList:[null],__eventManager:function(t){t||(t=window.event);var e=!0;try{t.srcElement&&(t.currentTarget=t.srcElement)}catch(t){}if(this.bxEventIndex&&jsEvent.objectEventList[this.bxEventIndex]&&jsEvent.objectEventList[this.bxEventIndex][t.type])for(var n=jsEvent.objectEventList[this.bxEventIndex][t.type].length,o=0;o<n;o++)if(jsEvent.objectEventList[this.bxEventIndex][t.type]&&jsEvent.objectEventList[this.bxEventIndex][t.type][o]){var i=jsEvent.objectEventList[this.bxEventIndex][t.type][o](t);if("boolean"==typeof i&&(e=e&&i),!e)return!1}return!0},addEvent:function(t,e,n){t.bxEventIndex||(t.bxEventIndex=jsEvent.objectList.length,jsEvent.objectList[t.bxEventIndex]=t),jsEvent.objectEventList[t.bxEventIndex]||(jsEvent.objectEventList[t.bxEventIndex]={}),jsEvent.objectEventList[t.bxEventIndex][e]||(jsEvent.objectEventList[t.bxEventIndex][e]=[],t["on"+e]&&jsEvent.objectEventList[t.bxEventIndex][e].push(t["on"+e]),t["on"+e]=null,t["on"+e]=jsEvent.__eventManager),jsEvent.objectEventList[t.bxEventIndex][e].push(n)},removeEvent:function(t,e,n){if(t.bxEventIndex&&jsEvent.objectEventList[t.bxEventIndex][e])for(var o=0;o<jsEvent.objectEventList[t.bxEventIndex][e].length;o++)if(n==jsEvent.objectEventList[t.bxEventIndex][e][o])return void delete jsEvent.objectEventList[t.bxEventIndex][e][o]},removeAllHandlers:function(t,e){t.bxEventIndex&&jsEvent.objectEventList[t.bxEventIndex][e]&&(jsEvent.objectEventList[t.bxEventIndex][e]=[])},removeAllEvents:function(t){t.bxEventIndex&&jsEvent.objectEventList[t.bxEventIndex]&&(jsEvent.objectEventList[t.bxEventIndex]=[])},clearObject:function(t){t.bxEventIndex&&(jsEvent.objectEventList[t.bxEventIndex]&&delete jsEvent.objectEventList[t.bxEventIndex],jsEvent.objectList[t.bxEventIndex]&&delete jsEvent.objectList[t.bxEventIndex],delete t.bxEventIndex)}},jsAjaxHistory={expected_hash:"",counter:0,bInited:!1,obFrame:null,obImage:null,bHashCollision:!1,obTimer:null,__hide_object:function(t){t.style.position="absolute",t.style.top="-1000px",t.style.left="-1000px",t.style.height="10px",t.style.width="10px"},init:function(t){if(!jsAjaxHistory.bInited){jsAjaxHistory.expected_hash=window.location.hash,jsAjaxHistory.expected_hash&&"#"!=jsAjaxHistory.expected_hash||(jsAjaxHistory.expected_hash="__bx_no_hash__");var e={node:t,title:window.document.title,data:document.getElementById(t).innerHTML},n=document.getElementById("navigation");null!=n&&(e.nav_chain=n.innerHTML),jsAjaxHistoryContainer.put(jsAjaxHistory.expected_hash,e),jsAjaxHistory.obTimer=setTimeout(jsAjaxHistory.__hashListener,500),jsAjaxUtil.IsIE()?(jsAjaxHistory.obFrame=document.createElement("IFRAME"),jsAjaxHistory.__hide_object(jsAjaxHistory.obFrame),document.body.appendChild(jsAjaxHistory.obFrame),jsAjaxHistory.obFrame.contentWindow.document.open(),jsAjaxHistory.obFrame.contentWindow.document.write(jsAjaxHistory.expected_hash),jsAjaxHistory.obFrame.contentWindow.document.close(),jsAjaxHistory.obFrame.contentWindow.document.title=window.document.title):jsAjaxUtil.IsOpera()&&(jsAjaxHistory.obImage=document.createElement("IMG"),jsAjaxHistory.__hide_object(jsAjaxHistory.obImage),document.body.appendChild(jsAjaxHistory.obImage),jsAjaxHistory.obImage.setAttribute("src","javascript:location.href = 'javascript:jsAjaxHistory.__hashListener();';")),jsAjaxHistory.bInited=!0}},__hashListener:function(){if(jsAjaxHistory.obTimer&&(window.clearTimeout(jsAjaxHistory.obTimer),jsAjaxHistory.obTimer=null),null!=jsAjaxHistory.obFrame)var t=jsAjaxHistory.obFrame.contentWindow.document.body.innerText;else t=window.location.hash;if(t&&"#"!=t||(t="__bx_no_hash__"),0==t.indexOf("#")&&(t=t.substring(1)),t!=jsAjaxHistory.expected_hash){var e=jsAjaxHistoryContainer.get(t);if(e&&(document.getElementById(e.node).innerHTML=e.data,jsAjaxUtil.UpdatePageTitle(e.title),e.nav_chain&&jsAjaxUtil.UpdatePageNavChain(e.nav_chain),jsAjaxHistory.expected_hash=t,null!=jsAjaxHistory.obFrame)){var n="__bx_no_hash__"==t?"":t;window.location.hash!=n&&window.location.hash!="#"+n&&(window.location.hash=n)}}jsAjaxHistory.obTimer=setTimeout(jsAjaxHistory.__hashListener,500)},put:function(t,e){var n={node:t,title:window.document.title,data:document.getElementById(t).innerHTML},o=document.getElementById("navigation");o&&(n.nav_chain=o.innerHTML),jsAjaxHistoryContainer.put(e,n),jsAjaxHistory.expected_hash=e,window.location.hash=jsAjaxUtil.urlencode(e),null!=jsAjaxHistory.obFrame&&(jsAjaxHistory.obFrame.contentWindow.document.open(),jsAjaxHistory.obFrame.contentWindow.document.write(e),jsAjaxHistory.obFrame.contentWindow.document.close(),jsAjaxHistory.obFrame.contentWindow.document.title=n.title)},checkRedirectStart:function(t,e){var n=window.location.hash;"#"==n.substring(0,1)&&(n=n.substring(1)),"view/"==n.substring(0,5)&&(jsAjaxHistory.bHashCollision=!0,document.write('<div id="__ajax_hash_collision_'+e+'" style="display: none;">'))},checkRedirectFinish:function(t,e){document.write("</div>");var n=window.location.hash;"#"==n.substring(0,1)&&(n=n.substring(1)),jsEvent.addEvent(window,"load",(function(){if("view/"==n.substring(0,5)){var o=document.getElementById("__ajax_hash_collision_"+e),i=o.firstChild;jsAjaxUtil.RemoveAllChild(i),o.style.display="block",jsAjaxUtil.IsIE()||jsAjaxUtil.IsOpera()||jsAjaxUtil.IsSafari()||(n=jsAjaxHistory.urlencode(n));var r="/bitrix/tools/ajax_redirector.php?hash="+(n+=(-1==n.indexOf("%3F")?"%3F":"%26")+t+"="+e);jsAjaxUtil.InsertDataToNode(r,i,!1)}}))},urlencode:function(t){return window.encodeURIComponent?encodeURIComponent(t):window.encodeURI?encodeURI(t):jsAjaxUtil.urlencode(t)}},jsAjaxHistoryContainer={arHistory:{},put:function(t,e){this.arHistory[t]=e},get:function(t){return this.arHistory[t]}};[].pop||(Array.prototype.pop=function(){if(this.length<=0)return!1;var t=this[this.length-1];return delete this[this.length-1],this.length--,t},Array.prototype.shift=function(){if(this.length<=0)return!1;var t=this.reverse(),e=t.pop();return this.prototype=t.reverse(),e},Array.prototype.push=function(t){this[this.length]=t});var jsAjax=new CAjax;