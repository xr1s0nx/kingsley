this.BX=this.BX||{},function(e,r){"use strict";var t=new WeakMap,n=new WeakMap,a=function(){function e(r,a){babelHelpers.classCallCheck(this,e),t.set(this,{writable:!0,value:""}),n.set(this,{writable:!0,value:{}}),babelHelpers.classPrivateFieldSet(this,t,r),babelHelpers.classPrivateFieldSet(this,n,a)}return babelHelpers.createClass(e,[{key:"getCurrency",value:function(){return babelHelpers.classPrivateFieldGet(this,t)}},{key:"getFormat",value:function(){return babelHelpers.classPrivateFieldGet(this,n)}},{key:"setFormat",value:function(e){babelHelpers.classPrivateFieldSet(this,n,e)}}]),e}(),i=function(){function e(){babelHelpers.classCallCheck(this,e)}return babelHelpers.createClass(e,null,[{key:"getCurrencyList",value:function(){return this.currencies}},{key:"setCurrencyFormat",value:function(e,t,n){if(r.Type.isStringFilled(e)&&r.Type.isPlainObject(t)){var i=this.getCurrencyIndex(e);if(!(i>-1)||n){var s=babelHelpers.objectSpread({},this.defaultFormat,t);-1===i?this.currencies.push(new a(e,s)):this.currencies[i].setFormat(s)}}}},{key:"setCurrencies",value:function(e,t){if(r.Type.isArray(e))for(var n=0;n<e.length;n++)r.Type.isPlainObject(e[n])&&r.Type.isStringFilled(e[n].CURRENCY)&&r.Type.isPlainObject(e[n].FORMAT)&&this.setCurrencyFormat(e[n].CURRENCY,e[n].FORMAT,t)}},{key:"getCurrencyFormat",value:function(e){var r=this.getCurrencyIndex(e);return r>-1&&this.getCurrencyList()[r].getFormat()}},{key:"getCurrencyIndex",value:function(e){for(var r=this.getCurrencyList(),t=0;t<r.length;t++)if(r[t].getCurrency()===e)return t;return-1}},{key:"clearCurrency",value:function(e){var r=this.getCurrencyIndex(e);r>-1&&(this.currencies=BX.util.deleteFromArray(this.currencies,r))}},{key:"clean",value:function(){this.currencies=[]}},{key:"currencyFormat",value:function(e,t,n){var a="",i=this.getCurrencyFormat(t);return r.Type.isObject(i)&&(i.CURRENT_DECIMALS=i.DECIMALS,"Y"===i.HIDE_ZERO&&e==parseInt(e,10)&&(i.CURRENT_DECIMALS=0),a=BX.util.number_format(e,i.CURRENT_DECIMALS,i.DEC_POINT,i.THOUSANDS_SEP),n&&(a=i.FORMAT_STRING.replace(/(^|[^&])#/,"$1"+a))),a}},{key:"loadCurrencyFormat",value:function(e){var r=this;return new Promise((function(t,n){var a=r.getCurrencyIndex(e);a>-1?t(r.getCurrencyList()[a].getFormat()):BX.ajax.runAction("currency.format.get",{data:{currencyId:e}}).then((function(n){var a=n.data;r.setCurrencyFormat(e,a),t(a)})).catch((function(e){n(e.errors)}))}))}}]),e}();babelHelpers.defineProperty(i,"currencies",[]),babelHelpers.defineProperty(i,"defaultFormat",{FORMAT_STRING:"#",DEC_POINT:".",THOUSANDS_SEP:" ",DECIMALS:2,HIDE_ZERO:"N"}),r.Reflection.namespace("BX.Currency").Core=i,e.CurrencyCore=i}(this.BX.Currency=this.BX.Currency||{},BX);